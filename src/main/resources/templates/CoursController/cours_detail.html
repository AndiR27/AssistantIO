{#include layout/base.html}
    {#contents}
        <div class="container">

            <!-- Header principal (titre + infos) -->
            <div class="coursee-header">
                <h1 class="title-large">{courseDTO.nom}</h1>
                <div class="coursee-details">
                    <p><strong>Code :</strong> {courseDTO.code}</p>
                    <p><strong>Professeur :</strong> {courseDTO.prof}</p>
                    <p><strong>Semestre :</strong> {courseDTO.semestre}</p>
                    <p><strong>Année académique :</strong> {courseDTO.annee}</p>
                </div>
            </div>

            <!-- Section d'ajouts -->
            <div class="add-section">
                <!-- 1) Ajout d’étudiant manuellement -->
                <form
                        hx-post="/course/{courseDTO.id}/addEtudiant"
                        hx-target="#etudiants-tp-table"
                        hx-swap="outerHTML"
                        method="POST"
                        class="mini-card"
                >
                    <h3 class="form-subtitle">Ajout d'un étudiant</h3>

                    <label for="nom">Nom</label>
                    <input type="text" id="nom" name="nom" required>

                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>

                    <label for="typeEtude">Type d'étude</label>
                    <select id="typeEtude" name="typeEtude">
                        <option value="temps_plein">Temps Plein</option>
                        <option value="temps_partiel">Temps partiel</option>
                    </select>

                    <button type="submit" class="btn-primary">Ajouter</button>
                </form>

                <!-- 2) Upload d’un fichier TXT pour ajouter plusieurs étudiants -->
                <form
                        hx-post="/course/{courseDTO.id}/ajoutEtudiantsTxt"
                        hx-encoding="multipart/form-data"
                        hx-target="#etudiants-tp-table"
                        hx-swap="outerHTML"
                        method="POST"
                        class="mini-card"
                >
                    <h3 class="form-subtitle">Ajout d'étudiants (fichier .txt)</h3>
                    <label for="txtFile">Fichier TXT</label>
                    <input type="file" id="txtFile" name="file" accept=".txt" required>

                    <button type="submit" class="btn-upload">Importer</button>
                </form>

                <!-- 3) Ajout d'un TP (nouvelle colonne) -->
                <form
                        hx-post="/course/{courseDTO.id}/addTP"
                        hx-target="#etudiants-tp-table"
                        hx-swap="outerHTML"
                        method="POST"
                        class="mini-card"
                >
                    <h3 class="form-subtitle">Ajout d'un Travail Pratique (TP)</h3>
                    <label for="numero">Numéro :</label>
                    <input type="number" id="numero" name="numero" required>
                    <button type="submit" class="btn-primary">Ajouter TP</button>
                </form>
            </div>

            <!-- GRAND TABLEAU Étudiants x TPs -->
            <div id="etudiants-tp-table" class="mt-10">
                <h2 class="title-form">Étudiants &amp; Travaux Pratiques</h2>

                <table class="etudiants-table">
                    <thead>
                    <tr>
                        <th>Nom</th>
                        <th>Email</th>
                        {#for tp in courseDTO.travauxPratiques}
                            <!-- nouveau code -->
                            <th style="white-space:nowrap;">
                                TP {tp.no}
                                <!-- On inclut le fichier de fragment pour le bouton "Ajouter Rendu ZIP" -->
                                {#include courseController/rendu_form.html courseId=courseDTO.id tpNo=tp.no /}

                            </th>
                        {/for}
                    </tr>
                    </thead>
                    <tbody>
                    {#for etudiant in courseDTO.etudiantsInscrits}
                        <tr>
                            <td>{etudiant.nom}</td>
                            <td>{etudiant.email}</td>
                            {#for tp in courseDTO.travauxPratiques}
                                <!-- Pour l'instant, on affiche 0, ou rien, ou la note ? -->
                                <td>0</td>
                            {/for}
                        </tr>
                    {/for}
                    </tbody>
                </table>
            </div>

            <!-- Lien retour -->
            <div class="back-link" style="margin-top:1.5rem;">
                <a href="/admin/home">← Retour à la liste des course</a>
            </div>

        </div>
    {/contents}
{/include}
