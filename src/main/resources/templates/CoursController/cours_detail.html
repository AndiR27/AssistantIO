{#include layout/base.html}
    {#contents}
        <div class="container">

            <!-- Header principal (titre + infos) -->
            <div class="course-header">
                <h1 class="title-large">{coursDTO.nom}</h1>
                <div class="course-details">
                    <p><strong>Code :</strong> {coursDTO.code}</p>
                    <p><strong>Professeur :</strong> {coursDTO.prof}</p>
                    <p><strong>Semestre :</strong> {coursDTO.semestre}</p>
                    <p><strong>Année académique :</strong> {coursDTO.annee}</p>
                </div>
            </div>

            <!-- Section d'ajouts -->
            <div class="add-section">
                <!-- 1) Ajout d’étudiant manuellement -->
                <form
                        hx-post="/cours/{coursDTO.id}/addEtudiant"
                        hx-target="#etudiants-tp-table"
                        hx-swap="outerHTML"
                        method="POST"
                        class="mini-card"
                >
                    <h3 class="form-subtitle">Ajout d'un étudiant</h3>

                    <label for="nom">Nom</label>
                    <input type="text" id="nom" name="nom" required>

                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>

                    <label for="typeEtude">Type d'étude</label>
                    <select id="typeEtude" name="typeEtude">
                        <option value="temps_plein">Temps Plein</option>
                        <option value="temps_partiel">Temps Partiel</option>
                    </select>

                    <button type="submit" class="btn-primary">Ajouter</button>
                </form>

                <!-- 2) Upload d’un fichier TXT pour ajouter plusieurs étudiants -->
                <form
                        hx-post="/cours/{coursDTO.id}/ajoutEtudiantsTxt"
                        hx-encoding="multipart/form-data"
                        hx-target="#etudiants-tp-table"
                        hx-swap="outerHTML"
                        method="POST"
                        class="mini-card"
                >
                    <h3 class="form-subtitle">Ajout d'étudiants (fichier .txt)</h3>
                    <label for="txtFile">Fichier TXT</label>
                    <input type="file" id="txtFile" name="file" accept=".txt" required>

                    <button type="submit" class="btn-upload">Importer</button>
                </form>

                <!-- 3) Ajout d'un TP (nouvelle colonne) -->
                <form
                        hx-post="/cours/{coursDTO.id}/addTP"
                        hx-target="#etudiants-tp-table"
                        hx-swap="outerHTML"
                        method="POST"
                        class="mini-card"
                >
                    <h3 class="form-subtitle">Ajout d'un Travail Pratique (TP)</h3>
                    <label for="numero">Numéro :</label>
                    <input type="number" id="numero" name="numero" required>
                    <button type="submit" class="btn-primary">Ajouter TP</button>
                </form>
            </div>

            <!-- GRAND TABLEAU Étudiants x TPs -->
            <div id="etudiants-tp-table" class="mt-10">
                <h2 class="title-form">Étudiants &amp; Travaux Pratiques</h2>

                <table class="etudiants-table">
                    <thead>
                    <tr>
                        <th>Nom</th>
                        <th>Email</th>
                        {#for tp in coursDTO.travauxPratiques}
                            <!-- nouveau code -->

                            <th style="white-space:nowrap;">
                                    {#include CoursController/rendu_form.html
                                    coursId=coursDTO.id
                                    tp=tp
                                    /}
                                TP {tp.no}
                                <!--
                                    Inclusion du fragment "rendu_form.html"
                                    pour gérer l’ajout de Rendu ZIP (ex. upload).
                                    On lui passe 3 paramètres @param : coursId, tpNo, ...
                                -->


                            </th>
                        {/for}
                    </tr>
                    </thead>
                    <tbody>
                    {#for etudiant in coursDTO.etudiantsInscrits}
                        <tr>
                            <td>{etudiant.nom}</td>
                            <td>{etudiant.email}</td>
                            {#for tp in coursDTO.travauxPratiques}
                                <!-- Pour l'instant, on affiche 0, ou rien, ou la note ? -->
                                <td>0</td>
                            {/for}
                        </tr>
                    {/for}
                    </tbody>
                </table>
            </div>

            <!-- Lien retour -->
            <div class="back-link" style="margin-top:1.5rem;">
                <a href="/admin/home">← Retour à la liste des cours</a>
            </div>

        </div>
    {/contents}
{/include}
